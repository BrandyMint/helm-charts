{{/*
Secrets for the application.
Supports both string values (will be base64 encoded) and file contents.
*/}}
{{- range .Values.secrets }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .name }}
  labels:
    {{- include "ror.labels" $ | nindent 4 }}
  {{- with .annotations }}
  annotations:
    {{- toYaml . | nindent 4 }}
  {{- end }}
type: {{ .type | default "Opaque" }}
data:
  {{- range $key, $value := .data }}
  {{- $strValue := toString $value }}
  {{- if hasPrefix "base64:" $strValue }}
  {{/* Value already base64 encoded (e.g., from readFile | b64enc) */}}
  {{ $key }}: {{ trimPrefix "base64:" $strValue }}
  {{- else }}
  {{/* Plain string value - encode to base64 */}}
  {{ $key }}: {{ $strValue | b64enc }}
  {{- end }}
  {{- end }}
{{- end }}
